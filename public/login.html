<!DOCTYPE html>
<html lang="pt">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Login | Brooklyn Barbearia</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link rel="stylesheet" href="css/public.css">
  <script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer></script>
</head>
<body>
  <!-- Header -->
  <div id="header-placeholder"></div>

  <!-- Container de Autenticação -->
  <div class="auth-container">
    <div class="auth-box">
      <!-- Tabs -->
      <div class="auth-tabs">
        <button class="auth-tab active" data-tab="login">Login</button>
        <button class="auth-tab" data-tab="register">Registar</button>
      </div>

      <!-- Formulário de Login -->
      <form id="loginForm" class="auth-form active">
        <h2>Iniciar Sessão</h2>

        <!-- Container OAuth com Overlay -->
        <div class="oauth-container "> <!-- colocar a classe disabled quando for para desativar os métodos social-login -->
          <div class="social-login-buttons">
              <button type="button" class="btn-social btn-google" id="loginGoogle">
                  <i class="fab fa-google"></i> Google
              </button>
            <button type="button" class="btn-social btn-facebook" id="loginFacebook">
              <i class="fab fa-facebook-f"></i> Facebook
            </button>
            <div class="oauth-button-wrapper">
              <button type="button" class="btn-social btn-instagram" id="loginInstagram">
                <i class="fab fa-instagram"></i> Instagram
              </button>
              <div class="oauth-single-overlay">
                <span>Instagram - Em breve</span>
              </div>
            </div>
          </div>
          
          <!-- Overlay Desfocado -->
          <div class="oauth-disabled-overlay">
            <div class="oauth-disabled-message">
              <i class="fas fa-info-circle"></i>
              <strong>Em breve</strong>
              Ainda não é possível fazer login com redes sociais. Por favor, use o seu email e password.
            </div>
          </div>
        </div>

        <div class="social-login-divider">
          <span>ou continue com email/telefone</span>
        </div>

        <div class="form-group">
          <label for="login-email">Email ou Telefone</label>
          <input type="text" id="login-email" placeholder="seu@email.com ou 912345678" required>
        </div>

        <div class="form-group">
          <label for="login-password">Password</label>
          <input type="password" id="login-password" required>
        </div>

        <a href="#" class="forgot-password" id="forgotPasswordLink">Esqueceu a password?</a>

        <!-- Turnstile Widget -->
        <div class="turnstile">
          <div class="cf-turnstile" data-sitekey="0x4AAAAAACHDJQSgIjOdWo9j"></div>
        </div>

        <button type="submit" class="btn-primary">Entrar</button>

        <div id="login-sucess" class="success-message" style="display: none;"></div>
        <div id="login-error" class="error-message" style="display: none;"></div>
      </form>

      <!-- Formulário de Registo -->
      <form id="registerForm" class="auth-form">
        <h2>Criar Conta</h2>

        <!-- Botões OAuth para Registo -->
        <div class="oauth-container "> <!-- colocar a classe disabled quando for para desativar os métodos social-login -->
          <div class="social-login-buttons">
              <button type="button" class="btn-social btn-google" id="registerGoogle">
                  <i class="fab fa-google"></i> Google
              </button>
            <button type="button" class="btn-social btn-facebook" id="registerFacebook">
              <i class="fab fa-facebook-f"></i> Facebook
            </button>
            <div class="oauth-button-wrapper">
              <button type="button" class="btn-social btn-instagram" id="registerInstagram">
                <i class="fab fa-instagram"></i> Instagram
              </button>
              <div class="oauth-single-overlay">
                <span>Instagram - Em breve</span>
              </div>
            </div>
          </div>
          
          <!-- Overlay Desfocado -->
          <div class="oauth-disabled-overlay">
            <div class="oauth-disabled-message">
              <i class="fas fa-info-circle"></i>
              <strong>Em breve</strong>
              Ainda não é possível criar conta com redes sociais. Por favor, use o seu email e password.
            </div>
          </div>
        </div>

        <div class="social-login-divider">
          <span>ou preencha os dados manualmente</span>
        </div>

        <!-- Alerta de Dados Pré-preenchidos -->
        <div id="oauth-prefill-alert" style="display: none;" class="alert alert-success">
          <i class="fas fa-check-circle"></i>
          <strong>Dados importados!</strong> Complete os campos abaixo.
        </div>
        <div id="completion-alert" style="display: none;" class="alert alert-info">
          <strong>Bem-vindo de volta!</strong> Parece que já fez reservas na Brooklyn mas nunca criou conta. Por favor, complete os seguintes campos para finalizar o seu perfil.
        </div>

        <div class="form-group">
          <label for="register-name">Nome Completo *</label>
          <input type="text" id="register-name" required>
        </div>

        <div class="form-group">
          <label for="register-email">Email *</label>
          <input type="email" id="register-email" required>
        </div>

        <div class="form-group">
          <label for="register-phone">Telefone *</label>
          <input type="tel" id="register-phone" placeholder="912345678">
        </div>

        <div class="form-group" id="password-field-group">
          <label for="register-password">Password <span id="password-optional" style="display: none; color: #888; font-weight: normal;">(opcional)</span></label>
          <input type="password" id="register-password" required minlength="8">
          <small>Mínimo 8 caracteres</small>
        </div>

        <div class="form-group" id="password-confirm-field-group">
          <label for="register-password-confirm">Confirmar Password</label>
          <input type="password" id="register-password-confirm" required>
        </div>

        <!-- Campo hidden para guardar o provider OAuth -->
        <input type="hidden" id="oauth-provider" value="">
        <input type="hidden" id="oauth-user-data" value="">

        <!-- Turnstile Widget -->
        <div class="turnstile">
          <div class="cf-turnstile" data-sitekey="0x4AAAAAACHDJQSgIjOdWo9j"></div>
        </div>

        <button type="submit" class="btn-primary">Criar Conta</button>

        <div id="register-error" class="error-message" style="display: none;"></div>
        <div id="register-success" class="success-message" style="display: none;"></div>
      </form>
    </div>
  </div>

  <!-- Modal de Reset de Password -->
  <div class="modal" id="resetPasswordModal">
    <div class="modal-content reset-password">
      <div class="modal-header">
        <h3>Recuperar Password</h3>
        <span class="close">&times;</span>
      </div>
      <div class="modal-body">
        <p>Insira o seu email para receber instruções de recuperação.</p>

        <form id="resetPasswordForm">
          <div class="form-group">
            <label for="reset-email">Email</label>
            <input type="email" id="reset-email" required>
          </div>

          <button type="submit" class="btn-primary">Enviar</button>

          <div id="reset-error" class="error-message" style="display: none;"></div>
          <div id="reset-success" class="success-message" style="display: none;"></div>
        </form>
      </div>
    </div>
  </div>

  <!-- Modal de Definir Nova Password -->
  <div class="modal" id="setNewPasswordModal">
    <div class="modal-content reset-password">
      <div class="modal-header">
        <h3>Definir Nova Password</h3>
        <span class="close">&times;</span>
      </div>
      <div class="modal-body">
        <p>Por favor, defina a sua nova password abaixo.</p>

        <form id="setNewPasswordForm">
          <input type="hidden" id="reset-token" value="">
          
          <div class="form-group">
            <label for="new-password">Nova Password</label>
            <input type="password" id="new-password" required minlength="8">
            <small>Mínimo 8 caracteres</small>
          </div>

          <div class="form-group">
            <label for="new-password-confirm">Confirmar Nova Password</label>
            <input type="password" id="new-password-confirm" required>
          </div>

          <button type="submit" class="btn-primary">Redefinir Password</button>

          <div id="set-password-error" class="error-message" style="display: none;"></div>
          <div id="set-password-success" class="success-message" style="display: none;"></div>
        </form>
      </div>
    </div>
  </div>

  <!-- Footer -->
  <div id="footer-placeholder"></div>

  <!-- Scripts -->
  <script src="js/utils.js"></script>
  <script src="js/main.js"></script>
  <script src="js/password-toggle.js"></script>
  <script src="js/auth.js"></script>
  
  <script>
    // Para ativar OAuth no futuro, remova a classe 'disabled':
    // document.querySelectorAll('.oauth-container').forEach(el => el.classList.remove('disabled'));
  </script>
</body>
</html>
